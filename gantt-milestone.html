<!DOCTYPE HTML>
<html lang="cn">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE"/>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Teamwork</title>

  <link rel=stylesheet href="platform.css" type="text/css">
  <link rel=stylesheet href="libs/jquery/dateField/jquery.dateField.css" type="text/css">

  <link rel=stylesheet href="time-line.css" type="text/css">

<!--  <link rel=stylesheet href="gantt.css" type="text/css">-->
<!--  <link rel=stylesheet href="ganttDrag.css" type="text/css">-->
<!--  <link rel=stylesheet href="ganttPrint.css" type="text/css" media="print">-->
<!--  <link rel=stylesheet href="libs/jquery/valueSlider/mb.slider.css" type="text/css" media="print">-->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
<!--  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">-->

<!--  <script src="https://cdn.jsdelivr.net/npm/jquery@3.1.1/dist/jquery.min.js"></script>-->
<!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>-->

<!--  <script src="jquery.min.js"></script>-->
<!--  <script src="jquery-ui.min.js"></script>-->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>
<!--  <script src="libs/jquery/jquery.livequery.1.1.1.min.js"></script>-->
<!--  <script src="libs/jquery/jquery.timers.js"></script>-->

<!--  <script src="libs/utilities.js"></script>-->
<!--  <script src="libs/forms.js"></script>-->
<!--  <script src="libs/date.js"></script>-->
<!--  <script src="libs/dialogs.js"></script>-->
<!--  <script src="libs/layout.js"></script>-->
<!--  <script src="libs/i18nJs.js"></script>-->
<!--  <script src="libs/jquery/dateField/jquery.dateField.js"></script>-->
  <script src="libs/jquery/JST/jquery.JST.js"></script>
<!--  <script src="libs/jquery/valueSlider/jquery.mb.slider.js"></script>-->

<!--  <script type="text/javascript" src="libs/jquery/svg/jquery.svg.min.js"></script>-->
<!--  <script type="text/javascript" src="libs/jquery/svg/jquery.svgdom.1.8.js"></script>-->

<!--  <script src="util/Stack.js"></script>-->
<!--  <script src="ganttUtilities.js"></script>-->
<!--  <script src="ganttTask.js"></script>-->
<!--  <script src="ganttDrawerSVG.js"></script>-->
<!--  <script src="ganttZoom.js"></script>-->
<!--  <script src="ganttTaskDrag.js"></script>-->
<!--  <script src="ganttGridEditor.js"></script>-->
<!--  <script src="ganttMaster.js"></script>  -->


  <!--<script src="libs/profiling.js"></script>-->
  <!--<script type="text/javascript" src="ganttTestSuite.js"></script>-->
</head>
<body style="background-color: #fff;">
<div class="dropdown">
  <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-expanded="false">
    Dropdown button
  </button>
  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
    <a class="dropdown-item" href="#">Action</a>
    <a class="dropdown-item" href="#">Another action</a>
    <a class="dropdown-item" href="#">Something else here</a>
  </div>
</div>

<div id="workSpace" class="container">
  <div class="row mb-2">
    <div class="col-xl-6 col-lg-8">
      <h3 class="font-weight-bold">里程碑时间轴</h3>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="timeline-steps aos-init aos-animate" data-aos="fade-up">
      </div>
    </div>
  </div>
  <div class="row mb-2">
    <div class="col-xl-6 col-lg-8">
      <h3 class="font-weight-bold">里程碑点列表</h3>
    </div>
  </div>

  <table id="mileStoneList" class="table thead-light">
    <thead class="thead-light">
    <tr>
      <th scope="col">名称</th>
      <th scope="col">负责人</th>
      <th scope="col">状态</th>
      <th scope="col">完成时间</th>
      <th scope="col">操作</th>
    </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
</div>


<script type="text/javascript">

  function MileStoneDTO(name, principal, status, baseLineDate) {
    this.name = name;
    this.principal = principal;
    this.status = status;
    this.baseLineDate = baseLineDate;
  }

$(function() {
  // var project=loadFromLocalStorage();
  //
  // ge.loadProject(project);
  $("#gantEditorTemplates").loadTemplates().remove();

  // TODO 构造视图对象
  let mileStoneVO = new MileStoneDTO("总体设计方案", "Benny", "已完成", '2020年12月29日21:05:47');
  let mileStoneVO1 = new MileStoneDTO("总体设计方案", "Benny", "已完成", '2020年12月29日21:05:47');
  let mileStoneVO2 = new MileStoneDTO("总体设计方案", "Benny", "已完成", '2020年12月29日21:05:47');
  const list = [];
  list.push(mileStoneVO);
  list.push(mileStoneVO1);
  list.push(mileStoneVO2);

  const table = $("#workSpace tbody");
  const timeline = $("#workSpace .timeline-steps");

  const now = new Date();

  list.forEach(dto => {
    let row = $.JST.createFromTemplate(dto, "MILESTONEROW");
    table.append(row);

    dto.now = now;
    let step = $.JST.createFromTemplate(dto, "TIMELINESTEP")
    timeline.append(step)
  })
});



function getDemoProject(){
  //console.debug("getDemoProject")
ret= {"tasks":    [
      {"id": -1, "name": "Gantt editor", "progress": 0, "progressByWorklog": false, "relevance": 0, "type": "", "typeId": "", "description": "", "code": "", "level": 0, "status": "STATUS_ACTIVE", "depends": "", "canWrite": true, "start": 1396994400000, "duration": 20, "end": 1399586399999, "startIsMilestone": false, "endIsMilestone": false, "collapsed": false, "assigs": [], "hasChild": true},
      {"id": -2, "name": "coding", "progress": 0, "progressByWorklog": false, "relevance": 0, "type": "", "typeId": "", "description": "", "code": "", "level": 1, "status": "STATUS_ACTIVE", "depends": "", "canWrite": true, "start": 1396994400000, "duration": 10, "end": 1398203999999, "startIsMilestone": false, "endIsMilestone": false, "collapsed": false, "assigs": [], "hasChild": true},
      {"id": -3, "name": "gantt part", "progress": 0, "progressByWorklog": false, "relevance": 0, "type": "", "typeId": "", "description": "", "code": "", "level": 2, "status": "STATUS_ACTIVE", "depends": "", "canWrite": true, "start": 1396994400000, "duration": 2, "end": 1397167199999, "startIsMilestone": false, "endIsMilestone": false, "collapsed": false, "assigs": [], "hasChild": false},
      {"id": -4, "name": "editor part", "progress": 0, "progressByWorklog": false, "relevance": 0, "type": "", "typeId": "", "description": "", "code": "", "level": 2, "status": "STATUS_SUSPENDED", "depends": "3", "canWrite": true, "start": 1397167200000, "duration": 4, "end": 1397685599999, "startIsMilestone": false, "endIsMilestone": false, "collapsed": false, "assigs": [], "hasChild": true},
      {"id": -9, "name": "dragging", "progress": 0, "progressByWorklog": false, "relevance": 0, "type": "", "typeId": "", "description": "", "code": "", "level": 3, "status": "STATUS_SUSPENDED", "depends": "3", "canWrite": true, "start": 1397167200000, "duration": 4, "end": 1397685599999, "startIsMilestone": false, "endIsMilestone": false, "collapsed": false, "assigs": [], "hasChild": false},
      {"id": -5, "name": "testing", "progress": 0, "progressByWorklog": false, "relevance": 0, "type": "", "typeId": "", "description": "", "code": "", "level": 1, "status": "STATUS_SUSPENDED", "depends": "2:5", "canWrite": true, "start": 1398981600000, "duration": 5, "end": 1399586399999, "startIsMilestone": false, "endIsMilestone": false, "collapsed": false, "assigs": [], "hasChild": true},
      {"id": -6, "name": "test on safari", "progress": 0, "progressByWorklog": false, "relevance": 0, "type": "", "typeId": "", "description": "", "code": "", "level": 2, "status": "STATUS_SUSPENDED", "depends": "", "canWrite": true, "start": 1398981600000, "duration": 2, "end": 1399327199999, "startIsMilestone": false, "endIsMilestone": false, "collapsed": false, "assigs": [], "hasChild": false},
      {"id": -7, "name": "test on ie", "progress": 0, "progressByWorklog": false, "relevance": 0, "type": "", "typeId": "", "description": "", "code": "", "level": 2, "status": "STATUS_SUSPENDED", "depends": "7", "canWrite": true, "start": 1399327200000, "duration": 3, "end": 1399586399999, "startIsMilestone": false, "endIsMilestone": false, "collapsed": false, "assigs": [], "hasChild": false},
      {"id": -8, "name": "test on chrome", "progress": 0, "progressByWorklog": false, "relevance": 0, "type": "", "typeId": "", "description": "", "code": "", "level": 2, "status": "STATUS_SUSPENDED", "depends": "7", "canWrite": true, "start": 1399327200000, "duration": 2, "end": 1399499999999, "startIsMilestone": false, "endIsMilestone": false, "collapsed": false, "assigs": [], "hasChild": false}
    ], "selectedRow": 2, "deletedTaskIds": [],
      "resources": [
      {"id": "tmp_1", "name": "Resource 1"},
      {"id": "tmp_2", "name": "Resource 2"},
      {"id": "tmp_3", "name": "Resource 3"},
      {"id": "tmp_4", "name": "Resource 4"}
    ],
      "roles":       [
      {"id": "tmp_1", "name": "Project Manager"},
      {"id": "tmp_2", "name": "Worker"},
      {"id": "tmp_3", "name": "Stakeholder"},
      {"id": "tmp_4", "name": "Customer"}
    ], "canWrite":    true, "canDelete":true, "canWriteOnParent": true, canAdd:true}


    //actualize data
    var offset=new Date().getTime()-ret.tasks[0].start;
    for (var i=0;i<ret.tasks.length;i++) {
      ret.tasks[i].start = ret.tasks[i].start + offset;
    }
  return ret;
}

function loadFromLocalStorage() {
  var ret;
  if (localStorage) {
    if (localStorage.getObject("teamworkGantDemo")) {
      ret = localStorage.getObject("teamworkGantDemo");
    }
  }

  //if not found create a new example task
  if (!ret || !ret.tasks || ret.tasks.length === 0){
    ret=getDemoProject();
  }
  return ret;
}

</script>


<div id="gantEditorTemplates" style="display:none;">
<div class="__template__" type="TASKSEDITHEAD"><!--
  <table class="gdfTable" cellspacing="0" cellpadding="0">
    <thead>
    <tr style="height:40px">
      <th class="gdfColHeader" style="width:35px; border-right: none"></th>
      <th class="gdfColHeader" style="width:25px;"></th>
      <th class="gdfColHeader gdfResizable" style="width:100px;">code/short name</th>
      <th class="gdfColHeader gdfResizable" style="width:300px;">name</th>
      <th class="gdfColHeader"  align="center" style="width:17px;" title="Start date is a milestone."><span class="teamworkIcon" style="font-size: 8px;">^</span></th>
      <th class="gdfColHeader gdfResizable" style="width:80px;">start</th>
      <th class="gdfColHeader"  align="center" style="width:17px;" title="End date is a milestone."><span class="teamworkIcon" style="font-size: 8px;">^</span></th>
      <th class="gdfColHeader gdfResizable" style="width:80px;">End</th>
      <th class="gdfColHeader gdfResizable" style="width:50px;">dur.</th>
      <th class="gdfColHeader gdfResizable" style="width:20px;">%</th>
      <th class="gdfColHeader gdfResizable requireCanSeeDep" style="width:50px;">depe.</th>
      <th class="gdfColHeader gdfResizable" style="width:1000px; text-align: left; padding-left: 10px;">assignees</th>
    </tr>
    </thead>
  </table>
  --></div>
<div class="__template__" type="MILESTONEROW"><!--
  <tr taskId="(#=obj.id#)">
    <td>(#=obj.name#)</td>
    <td>(#=obj.principal#)</td>
    <td>(#=obj.status#)</td>
    <td>(#=obj.baseLineDate#)</td>
    <td><span>查看</span><span>修改</span><span>查看</span></td>
  </tr>
  --></div>

  <div class="__template__" type="TIMELINESTEP"><!--
  <div class="timeline-step">
          <div class="timeline-content">
            <div class="inner-circle"></div>
            <p class="h6 mt-1 mb-1">(#=obj.name#)</p>
            <p class="h6 text-muted mb-0 mb-lg-0">当前: (#=obj.now#)</p>
            <p class="h6 text-muted mb-0 mb-lg-0">基线: (#=obj.baseLineDate#)</p>
            <p class="h6 text-muted mb-0 mb-lg-0">负责人: (#=obj.principal#)</p>
            <p class="h6 text-muted mb-0 mb-lg-0">相差天数: TODO</p>
          </div>
        </div>
  --></div>

</div>


</body>
</html>